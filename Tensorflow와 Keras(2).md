### 모델생성

```python
import pandas as pd 
import numpy as np

path = "C:\\Users\\student\\Desktop\\DY\\★ 데이터\\105. deep-learning-dataset\\"
data = pd.read_csv(path+"ThoraricSurgery.csv",header=None)

import tensorflow as tf

tf.set_random_seed(777)

w = tf.Variable(tf.random_normal([1]),name="weight")
b = tf.Variable(tf.random_normal([1]),name="bias")

x = tf.placeholder(tf.float32, shape = [None])
y = tf.placeholder(tf.float32, shape = [None])

hf = x * w +b
cost =  tf.reduce_mean(tf.square(hf - y))
# 예측값 - 실제값 -> 제곱 - > 합 -> 평균 

opt = tf.train.GradientDescentOptimizer(learning_rate=0.0001)
train = opt.minimize(cost)

sess = tf.Session()
sess.run(tf.global_variables_initializer())

import matplotlib.pyplot as plt 

# 비용함수 점찍기위한 함수 
W_history = []
cost_history = []

for step in range(1001):
    _, cv, bw, wv= sess.run([train, cost, b, w], feed_dict = {x:[16,20,22],y:[30,40,50]})
    cost_history.append(cv)
    W_history.append(wv[0])
    if step % 100==0:
        print(step, cv,bw,wv)
        
plt.plot(W_history,cost_history) # 모델을 실행하면서 cost가 어떻게 줄어드는지 확인
plt.show()
        
>>> 
0 108.77133 [-1.4742886] [2.5578232]
100 10.409368 [-1.4742886] [2.0878928]
200 10.409354 [-1.4742886] [2.0877206]
300 10.409354 [-1.4742886] [2.0877206]

```

![img](data:image/png;base64,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)

```python
path = "C:\\Users\\student\\Desktop\\DY\\★ 데이터\\105. deep-learning-dataset\\"
data = pd.read_csv(path+"ThoraricSurgery.csv",header=None)

tf.set_random_seed(777)

w = tf.Variable(tf.random_normal([1]),name="weight")
b = tf.Variable(tf.random_normal([1]),name="bias")

x = tf.placeholder(tf.float32, shape = [None])
y = tf.placeholder(tf.float32, shape = [None])

hf = x * w + b 

cost =  tf.reduce_mean(tf.square(hf - y))

opt = tf.train.GradientDescentOptimizer(learning_rate=0.0001)
train = opt.minimize(cost)

sess = tf.Session()
sess.run(tf.global_variables_initializer())

import matplotlib.pyplot as plt 

# 비용함수 점찍기위한 함수 
W_history = []
cost_history = []

for step in range(10001):
    _, cv, bw, wv= sess.run([train, cost, b, w], feed_dict = {x:[16,20,22],y:[30,40,50]})
    cost_history.append(cv)
    W_history.append(wv[0])
    if step % 1000==0:
        print(step, cv,bw,wv)
        
plt.plot(W_history,cost_history) # 모델을 실행하면서 cost가 어떻게 줄어드는지 확인
plt.show()

>>>
0 4904.004 [0.17607975] [-1.2363415]
1000 10.607109 [0.2709783] [2.073884]
2000 10.553542 [0.19788411] [2.0776029]
```

![img](data:image/png;base64,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)

### 모델평가 

```python
# 모델평가
print(sess.run(hf, feed_dict={x:[10]}))
print(sess.run(hf, feed_dict={x:[10,10.5]}))
print(sess.run(hf, feed_dict={x:[10,10.5,20,100]}))

>>>
[20.690859]
[20.690859 21.744318]
[ 20.690859  21.744318  41.76005  210.3136  ]

#변수값 초기화

w=tf.Variable([100.],tf.float32)
b=tf.Variable([-10.],tf.float32)
x=tf.placeholder(tf.float32)
y=tf.placeholder(tf.float32)
#hf=100 * x - 10

hf=x*w+b
cost=tf.reduce_sum(tf.square(hf-y))

opt=tf.train.GradientDescentOptimizer(0.01)
train=opt.minimize(cost)

xtrain=[1,2,3,4,5]
ytrain=[0,-1,-2,-3,-4]

sess=tf.Session()
sess.run(tf.global_variables_initializer())

for i in range(1000):
    sess.run(train, {x:xtrain,y:ytrain})
    
wv,bv,costv=sess.run([w,b,cost], {x:xtrain, y:ytrain})
print("weight:%s bias:%s cost:%s" %(wv,bv,costv))


>>>
weight:[-0.9999995] bias:[0.99999833] cost:2.5579538e-12
```

```python
###경사하강법에서 update 구문 작성
xdata=[1,2,3]
ydata=[1,2,3]

w=tf.Variable(tf.random_normal([1]))
x=tf.placeholder(tf.float32)
y=tf.placeholder(tf.float32)

hf=x*w

lr=0.1
cost=tf.reduce_mean(tf.square(hf-y))
gradient=tf.reduce_mean((w*x-y)*x)
descent=w-lr*gradient
update=w.assign(descent)

sess.run(tf.global_variables_initializer())
for step in range(21):
    sess.run(update,feed_dict={x:xdata,y:ydata})
    print(step, sess.run(cost,feed_dict={x:xdata,y:ydata}), sess.run(w))
    
>>>
0 3.96544 [0.07818806]
1 1.1279477 [0.50836694]
2 0.32083848 [0.7377957]
3 0.091260694 [0.8601577]
4 0.025958618 [0.9254174]
5 0.0073838024 [0.9602226]
```



### 모델생성

```python
# 데이터 읽기 
path = "C:\\Users\\student\\Desktop\\DY\\★ 데이터\\306. carsdata"
cars=pd.read_csv(path + "\\cars.csv")

# 사용할 데이터 칼럼 및 xtrain , ytrain
data=cars[[' cylinders',' hp']]
xtrain = list(data[' cylinders'])
ytrain = list(data[' hp'])

# w, b random 변수 설정 
import tensorflow as tf

w = tf.Variable(tf.random_normal([1]))
b = tf.Variable(tf.random_normal([1]))

# 가설함수 설정 
hf = xtrain*w + b

sess = tf.Session()
sess.run(tf.global_variables_initializer())

cost = tf.reduce_mean(tf.square(hf - ytrain)) # (예상값 - 실제값 ) 합의 제곱에 대한 평균 

opt = tf.train.GradientDescentOptimizer(0.0001) # alpha 값 
train = opt.minimize(cost) # 경사 하강 알고리즘 

# cost , w, b 출력 
sess.run(train)
print(sess.run(cost), sess.run(w), sess.run(b))



# 임의의 실린더 값 입력했을 때 예측값 출력 
for x in [10,12,16]:
    yhat = sess.run(w)[0] * x + sess.run(b)[0]
    print("실린더가 {}일때 예상되는 hp값은 {}".format(x,yhat))
    
>>>
12264.211 [0.49276823] [0.22389925]
실린더가 10일때 예상되는 hp값은 5.151581525802612
실린더가 12일때 예상되는 hp값은 6.137117981910706
실린더가 16일때 예상되는 hp값은 8.108190894126892


```



## cost함수 시각화 

```python
# cost함수 그래프 시각화 
xtrain = list(data[' cylinders'])
ytrain = list(data[' hp'])

W = tf.placeholder(tf.float32)

# 선형모델의 가설
hypothesis = xtrain * W

# 비용함수 
cost = tf.reduce_mean(tf.square(hypothesis - ytrain))

# session 설정 
sess = tf.Session()

# 비용함수 점찍기위한 함수 
W_history = []
cost_history = []

for i in range(-30, 70):
    curr_W = i
    curr_cost = sess.run(cost, feed_dict={W: curr_W})
    W_history.append(curr_W)
    cost_history.append(curr_cost)

# Show the cost function
plt.plot(W_history, cost_history)
plt.show()
```

![img](data:image/png;base64,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)



## 다중선형회귀

```python
x1data = [73,93,90,95,72] # 모의고사 점수 
x2data = [80,88,92,98,66] # 모의고사 점수 
x3data = [75,92,90,100,70] # 모의고사 점수 
ydata = [152,185,180,195,140] # 수능 점수 

x1 = tf.placeholder(tf.float32)
x2 = tf.placeholder(tf.float32)
x3 = tf.placeholder(tf.float32)
y = tf.placeholder(tf.float32)

# 안좋은 코드 
w1 = tf.Variable(tf.random_normal([1]))
w2 = tf.Variable(tf.random_normal([1]))
w3 = tf.Variable(tf.random_normal([1]))
b = tf.Variable(tf.random_normal([1]))
hf = x1*w1 + x2 * w2 + x3 * w3 + b 

cost = tf.reduce_mean(tf.square( hf - y))

opt = tf.train.GradientDescentOptimizer(1e-5)
train = opt.minimize(cost)

sess = tf.Session()
sess.run(tf.global_variables_initializer())

for step in range(2001):
    cv, hfv, _ = sess.run([cost, hf, train], feed_dict={x1:x1data, x2:x2data, x3:x3data , y:ydata})
    if step%10==0:
        print(step,"cost:",cv, "\n prediction:",hfv)
        
>>>
0 cost: 31.840847 
 prediction: [141.86623 185.08005 176.69302 189.03435 143.15901]
10 cost: 20.632406 
 prediction: [144.83269 188.60138 180.21767 192.8316  145.83716]

```



#### 연습



```python

### 행렬곱셈 형태로 변환 
xdata=[[73,93,90,95,72], # 모의고사 점수 
        [80,88,92,98,66], # 모의고사 점수 
        [75,92,90,100,70]] # 모의고사 점수 
ydata=[[152],[185],[180],[195],[140]] # 수능 점수 

xdata = np.array(xdata).T
ydata
>>>
[[152], [185], [180], [195], [140]]
xdata.shape
>>>
(5, 3)
np.shape(ydata)
(5, 1)

x=tf.placeholder(tf.float32,shape=[None,3])
y=tf.placeholder(tf.float32,shape=[None,1])
w=tf.Variable(tf.random_normal([3,1]))
b=tf.Variable(tf.random_normal([1]))

hf=tf.matmul(x,w) + b 
   #(5,3) * (3*1) + 1 
    
cost = tf.reduce_mean(tf.square(hf-y))

opt = tf.train.GradientDescentOptimizer(1e-5)
train = opt.minimize(cost)

sess=tf.Session()
sess.run(tf.global_variables_initializer())

for step in range(2000):
    hfv, cv,_ = sess.run([hf,cost,train], feed_dict={x:xdata, y:ydata })
    if step%10==0:
        print(cv,hfv)
>>>

```

#### 연습

```python

data=pd.read_csv("data-01-test-score.csv",header=None)
xtrain=data.loc[:,0:2].as_matrix().T
ytrain=pd.DataFrame(data.loc[:,3]).as_matrix()

xtrain=xtrain.T
ytrain.shape #(25, 1)

x=tf.placeholder(tf.float32,shape=[None,3])
y=tf.placeholder(tf.float32,shape=[None,1])
w=tf.Variable(tf.random_normal([3,1]))
b=tf.Variable(tf.random_normal([1]))

hf=tf.matmul(x,w) + b 
   #(3,25) * (25*1) + 1 
    
cost = tf.reduce_mean(tf.square(hf-y))

opt = tf.train.GradientDescentOptimizer(1e-5)
train = opt.minimize(cost)

sess=tf.Session()
sess.run(tf.global_variables_initializer())

for step in range(2000):
    hfv, cv,_ = sess.run([hf,cost,train], feed_dict={x:xtrain, y:ytrain })
    if step%10==0:
        print(cv,hfv)


```

```python
sess=tf.Session()
sess.run(tf.global_variables_initializer())

print("Your score will be ", sess.run(hf, 
                                      feed_dict={x: [[100,100, 100]]}))

print("Other scores will be ", sess.run(hf,
                                        feed_dict={x: [[90, 90, 90], [90, 100, 80]]}))

>>>
Your score will be  [[68.09386]]
Other scores will be  [[61.208847]
 [44.56183 ]]

```



## 로지스틱 회귀(분류)

```python
xdata = [[1,2],
        [2,3],
        [3,1],
        [4,3],
        [5,3],
        [6,2]]

ydata = [[0],
        [0],
        [0],
        [1],
        [1],
        [1]]

xdata[0]
>> [1, 2]

x=tf.placeholder(tf.float32 , shape = [None,2])
y=tf.placeholder(tf.float32 , shape = [None,1])
w=tf.Variable(tf.random_normal([2,1]))
b=tf.Variable(tf.random_normal([1]))

hf =tf.sigmoid(tf.matmul(x,w)+b)
cost = - tf.reduce_mean(y* tf.log(hf)+ (1-y)*(tf.log(1-hf)))

train = tf.train.GradientDescentOptimizer(0.01).minimize(cost)

# 0.5 기준 (크면 ->1.0, 작으면 ->0.0)
predicted = tf.cast(hf>0.5, dtype=tf.float32)
accuracy = tf.reduce_mean(tf.cast(tf.equal(predicted,y),dtype=tf.float32))

step_list=[]
cost_list=[]
with tf.Session() as sess:
    sess.run(tf.global_variables_initializer())
    for step in range(20001):
        _,cv= sess.run([train, cost], feed_dict={x:xdata,y:ydata})
        if step%1000==0:
            print(step,cv )
        step_list.append(step)
        cost_list.append(cv)
    hv, pv, av= sess.run([hf, predicted, accuracy], feed_dict={x:xdata,y:ydata})
    print("예측값:\n",hv, "\n예측분류:\n",pv,"\n정확도",av*100,"%")
plt.plot(step_list,cost_list)

0 1.5669492
1000 0.4796742
2000 0.39282265
3000 0.33484963
4000 0.2899173
5000 0.2545438
6000 0.22631872
7000 0.20345835
8000 0.18466349
9000 0.1689914
10000 0.15575267
11000 0.14443757
12000 0.1346644
13000 0.12614335
14000 0.118651
15000 0.11201316
16000 0.106092244
17000 0.10077823
18000 0.09598244
19000 0.09163236
20000 0.0876685
예측값:
 [[0.00970011]
 [0.11316934]
 [0.1777659 ]
 [0.8475492 ]
 [0.97347146]
 [0.9919165 ]] 
예측분류:
 [[0.]
 [0.]
 [0.]
 [1.]
 [1.]
 [1.]] 
정확도 100.0 %
```



![img](data:image/png;base64,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)



## 과제

```python
# 데이터불러오기
import pandas as pd
path = "C:\\Users\\student\\Desktop\\DY\\★ 데이터\\105. deep-learning-dataset\\"
data = pd.read_csv(path+"ThoraricSurgery.csv",header=None)

# xtrain, ytrain 데이터 분리 
xdata=data.iloc[:,0:17]
ydata=pd.DataFrame(data.iloc[:,17])

xtrain=[]
for i in range(len(xdata)):
    xtrain.append(list(xdata.loc[i,:]))

ytrain=[]
for i in range(len(ydata)):
    ytrain.append(list(ydata.loc[i]))

# 가설함수 정의 
import tensorflow as tf
x=tf.placeholder(tf.float32 , shape = [None,17])
y=tf.placeholder(tf.float32 , shape = [None,1])
w=tf.Variable(tf.random_normal([17,1]))
b=tf.Variable(tf.random_normal([1]))

hf =tf.matmul(x,w)+b

#비용함수 정의 
cost = tf.reduce_mean(tf.square(hf-y))

# 트레이닝
train = tf.train.GradientDescentOptimizer(1e-5).minimize(cost)

#예측 및 정확도 설정 
# 0.5 기준 (크면 ->1.0, 작으면 ->0.0)
predicted = tf.cast(hf>0.5, dtype=tf.float32)
accuracy = tf.reduce_mean(tf.cast(tf.equal(predicted,y),dtype=tf.float32))

# 결과 표시 
import matplotlib.pyplot as plt

step_list=[]
cost_list=[]
with tf.Session() as sess:
    sess.run(tf.global_variables_initializer())
    for step in range(2001):
        _,cv= sess.run([train, cost], feed_dict={x:xtrain,y:ytrain})
        if step%400==0:
            print(step,cv )
        step_list.append(step)
        cost_list.append(cv)
    hv, pv, av= sess.run([hf, predicted, accuracy], feed_dict={x:xtrain,y:ytrain})
    print("예측값:\n",hv, "\n예측분류:\n",pv,"\n정확도",av*100,"%")
plt.plot(step_list,cost_list)

>>>
0 68503.88
400 6.71124
800 6.4712024
1200 6.2499557
1600 6.0403056
2000 5.840947
>>>
예측값:
 [[ 3.98588181e-03]
 [ 5.34307957e-01]
 [-2.10866213e+00]
 [-3.01638079e+00]
 [ 2.40203381e-01]
 [ 1.62319613e+00]
 [-4.60672998e+00]
 [-4.40431118e-01]
 [-1.59862661e+00]
 [ 3.19408274e+00]
 [-1.60200739e+00]
 [-1.79153013e+00]
 [ 2.92085886e+00]
..... 
  
 >>> 
  예측분류:
 [[0.]
 [1.]
 [0.]
 [0.]
 [0.]
 [1.]
 [0.]
 [0.]
 ..... 
  
 >>> 
정확도 50.212764739990234 %
  
  
  
  # test 데이터 나눠 진행 
  
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(xtrain,ytrain, test_size=0.3, random_state=33)

step_list=[]
cost_list=[]
with tf.Session() as sess:
    sess.run(tf.global_variables_initializer())
    for step in range(2001):
        _,cv= sess.run([train, cost], feed_dict={x:X_test,y:y_test})
        if step%400==0:
            print(step,cv )
        step_list.append(step)
        cost_list.append(cv)
    hv, pv, av= sess.run([hf, predicted, accuracy], feed_dict={x:X_test,y:y_test})
    print("예측값:\n",hv, "\n예측분류:\n",pv,"\n정확도",av*100,"%")
plt.plot(step_list,cost_list)
  
>>>
0 7389.5044
400 27.899775
800 11.1605215
1200 8.983628
1600 8.382461
2000 7.968936
예측값:
 [[ 1.8554791e+00]
 [-4.8638468e+00]
 [-7.1642714e+00]
 [ 4.3414135e+00]
 [ 3.9648044e-01]
 [-4.3882096e-01]
 [ 2.3591585e+00]
 [-2.4268544e-01]
..... 
예측분류:
 [[1.]
 [0.]
 [0.]
 [1.]
 [0.]
 [0.]
 [1.]
...... 
정확도 58.156025409698486 %
```

